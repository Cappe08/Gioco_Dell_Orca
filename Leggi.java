public class Main {

    public static void main(String[] args) {
        System.out.println("    GIOCO DELL'OCA  ");
          Domanda[] tutteDomande = new Domanda[90];
    tutteDomande[0] = new Domanda("Qual è la capitale della Francia?", 
        new String[]{"Parigi", "Londra", "Berlino", "Madrid"}, 1, 10, 1, 1);

    tutteDomande[1] = new Domanda("Qual è il fiume più lungo d'Italia?", 
        new String[]{"Tevere", "Arno", "Po", "Adige"}, 3, 10, 1, 2);

    tutteDomande[2] = new Domanda("In quale continente si trova l'Egitto?", 
        new String[]{"Asia", "Africa", "Europa", "America"}, 2, 10, 1, 3);

    tutteDomande[3] = new Domanda("Qual è l'oceano più grande del mondo?", 
        new String[]{"Atlantico", "Indiano", "Pacifico", "Artico"}, 3, 10, 1, 4);

    tutteDomande[4] = new Domanda("Qual è la capitale del Regno Unito?", 
        new String[]{"Dublino", "Londra", "Edimburgo", "Cardiff"}, 2, 10, 1, 5);

    tutteDomande[5] = new Domanda("Dove si trova il Colosseo?", 
        new String[]{"Milano", "Napoli", "Roma", "Venezia"}, 3, 10, 1, 6);

    tutteDomande[6] = new Domanda("Quale nazione ha la forma di uno stivale?", 
        new String[]{"Spagna", "Grecia", "Italia", "Portogallo"}, 3, 10, 1, 7);

    tutteDomande[7] = new Domanda("Qual è la montagna più alta del mondo?", 
        new String[]{"K2", "Monte Bianco", "Everest", "Kilimangiaro"}, 3, 10, 2, 8);

    tutteDomande[8] = new Domanda("Di che nazione è la bandiera del 'Sol Levante'?", 
        new String[]{"Cina", "Giappone", "Corea del Sud", "Vietnam"}, 2, 10, 1, 9);

    tutteDomande[9] = new Domanda("Qual è la capitale della Spagna?", 
        new String[]{"Barcellona", "Madrid", "Siviglia", "Lisbona"}, 2, 10, 1, 10);

    tutteDomande[10] = new Domanda("Quale regione italiana ha come capoluogo Firenze?", 
        new String[]{"Umbria", "Lazio", "Toscana", "Marche"}, 3, 10, 1, 11);

    tutteDomande[11] = new Domanda("In che città si trova la Statua della Libertà?", 
        new String[]{"Washington", "Los Angeles", "New York", "Chicago"}, 3, 10, 1, 12);

    tutteDomande[12] = new Domanda("Qual è il lago più grande d'Italia?", 
        new String[]{"Lago Maggiore", "Lago di Como", "Lago di Garda", "Trasimeno"}, 3, 10, 2, 13);

    tutteDomande[13] = new Domanda("Quale canale separa il Regno Unito dalla Francia?", 
        new String[]{"Suez", "Panama", "La Manica", "Gibilterra"}, 3, 10, 2, 14);

    tutteDomande[14] = new Domanda("Qual è la capitale della Germania?", 
        new String[]{"Monaco", "Amburgo", "Francoforte", "Berlino"}, 4, 10, 1, 15);






    tutteDomande[15] = new Domanda("In che anno è stata scoperta l'America?", 
        new String[]{"1492", "1500", "1348", "1776"}, 1, 10, 1, 16);

    tutteDomande[16] = new Domanda("Chi fu il primo imperatore romano?", 
        new String[]{"Giulio Cesare", "Nerone", "Augusto", "Traiano"}, 3, 10, 2, 17);

    tutteDomande[17] = new Domanda("Quale civiltà costruì le piramidi?", 
        new String[]{"Romani", "Greci", "Egizi", "Maya"}, 3, 10, 1, 18);

    tutteDomande[18] = new Domanda("Chi ha dipinto la Gioconda?", 
        new String[]{"Michelangelo", "Raffaello", "Leonardo da Vinci", "Giotto"}, 3, 10, 1, 19);

    tutteDomande[19] = new Domanda("Come si chiamava il dittatore tedesco della II Guerra Mondiale?", 
        new String[]{"Mussolini", "Stalin", "Hitler", "Franco"}, 3, 10, 1, 20);

    tutteDomande[20] = new Domanda("In che anno è caduto il Muro di Berlino?", 
        new String[]{"1945", "1960", "1989", "2001"}, 3, 10, 2, 21);

    tutteDomande[21] = new Domanda("Chi fu il primo uomo ad andare sulla Luna?", 
        new String[]{"Gagarin", "Aldrin", "Armstrong", "Collins"}, 3, 10, 2, 22);

    tutteDomande[22] = new Domanda("Qual era una moneta dell'Antica Roma?", 
        new String[]{"Euro", "Fiorino", "Sesterzio", "Lira"}, 3, 10, 2, 23);

    tutteDomande[23] = new Domanda("Chi ha 'sciacquato i panni in Arno'?", 
        new String[]{"Dante", "Manzoni", "Petrarca", "Boccaccio"}, 2, 10, 2, 24);

    tutteDomande[24] = new Domanda("Quale vulcano distrusse Pompei?", 
        new String[]{"Etna", "Stromboli", "Vesuvio", "Vulcano"}, 3, 10, 1, 25);

    tutteDomande[25] = new Domanda("Chi è il patrono d'Italia?", 
        new String[]{"San Pietro", "San Francesco", "San Gennaro", "San Marco"}, 2, 10, 2, 26);

    tutteDomande[26] = new Domanda("Come si chiamava una delle caravelle di Colombo?", 
        new String[]{"Santa Lucia", "Santa Maria", "San Giorgio", "Santa Rita"}, 2, 10, 1, 27);

    tutteDomande[27] = new Domanda("Chi ha inventato la lampadina?", 
        new String[]{"Tesla", "Volta", "Edison", "Marconi"}, 3, 10, 1, 28);

    tutteDomande[28] = new Domanda("Quale guerra si combatté tra il 1914 e il 1918?", 
        new String[]{"II Guerra Mondiale", "Vietnam", "I Guerra Mondiale", "Guerra Fredda"}, 3, 10, 1, 29);

    tutteDomande[29] = new Domanda("Chi fu incoronato imperatore nella notte di Natale dell'800?", 
        new String[]{"Napoleone", "Carlo Magno", "Giulio Cesare", "Barbarossa"}, 2, 10, 2, 30);



    tutteDomande[30] = new Domanda("Qual è il pianeta più vicino al Sole?", 
        new String[]{"Venere", "Mercurio", "Marte", "Terra"}, 2, 10, 1, 31);

    tutteDomande[31] = new Domanda("Qual è la formula chimica dell'acqua?", 
        new String[]{"CO2", "H2O", "O2", "NaCl"}, 2, 10, 1, 32);

    tutteDomande[32] = new Domanda("Quante zampe ha un ragno?", 
        new String[]{"6", "8", "10", "12"}, 2, 10, 1, 33);

    tutteDomande[33] = new Domanda("Qual è l'animale più veloce della terraferma?", 
        new String[]{"Leone", "Cavallo", "Ghepardo", "Gazzella"}, 3, 10, 1, 34);

    tutteDomande[34] = new Domanda("Cosa usano i pesci per respirare?", 
        new String[]{"Polmoni", "Branchie", "Pelle", "Naso"}, 2, 10, 1, 35);

    tutteDomande[35] = new Domanda("Qual è il 'Pianeta Rosso'?", 
        new String[]{"Giove", "Saturno", "Marte", "Mercurio"}, 3, 10, 1, 36);

    tutteDomande[36] = new Domanda("Quanti denti ha un adulto completo?", 
        new String[]{"28", "30", "32", "34"}, 3, 10, 2, 37);

    tutteDomande[37] = new Domanda("Qual è il mammifero più grande del mondo?", 
        new String[]{"Elefante", "Balenottera azzurra", "Orinoco", "Ippopotamo"}, 2, 10, 2, 38);

    tutteDomande[38] = new Domanda("A quanti gradi bolle l'acqua?", 
        new String[]{"50°C", "90°C", "100°C", "120°C"}, 3, 10, 1, 39);

    tutteDomande[39] = new Domanda("Qual è l'osso più lungo del corpo umano?", 
        new String[]{"Omero", "Femore", "Tibia", "Perone"}, 2, 10, 2, 40);

    tutteDomande[40] = new Domanda("Come si chiama il processo con cui le piante creano energia?", 
        new String[]{"Digestione", "Fotosintesi", "Osmosi", "Respirazione"}, 2, 10, 2, 41);

    tutteDomande[41] = new Domanda("Quanti cuori ha un polpo?", 
        new String[]{"1", "2", "3", "4"}, 3, 10, 3, 42);

    tutteDomande[42] = new Domanda("Quale gas respiriamo per vivere?", 
        new String[]{"Elio", "Azoto", "Ossigeno", "Idrogeno"}, 3, 10, 1, 43);

    tutteDomande[43] = new Domanda("Cosa studia l'astronomia?", 
        new String[]{"Gli astri", "Le piante", "Gli atomi", "Il futuro"}, 1, 10, 1, 44);

    tutteDomande[44] = new Domanda("Il pomodoro è tecnicamente...", 
        new String[]{"Una verdura", "Un frutto", "Una radice", "Un tubero"}, 2, 10, 2, 45);



    tutteDomande[45] = new Domanda("Chi ha scritto la Divina Commedia?", 
        new String[]{"Petrarca", "Boccaccio", "Dante", "Leopardi"}, 3, 10, 1, 46);

    tutteDomande[46] = new Domanda("Chi ha scolpito il David?", 
        new String[]{"Donatello", "Michelangelo", "Bernini", "Canova"}, 2, 10, 1, 47);

    tutteDomande[47] = new Domanda("Quale burattino voleva diventare un bambino vero?", 
        new String[]{"Geppetto", "Lucignolo", "Pinocchio", "Mangiafuoco"}, 3, 10, 1, 48);

    tutteDomande[48] = new Domanda("Chi ha scritto 'I Promessi Sposi'?", 
        new String[]{"Verga", "Pascoli", "Manzoni", "Pirandello"}, 3, 10, 1, 49);

    tutteDomande[49] = new Domanda("Chi è il dio del tuono norreno?", 
        new String[]{"Odino", "Loki", "Thor", "Freya"}, 3, 10, 1, 50);

    tutteDomande[50] = new Domanda("Chi ha scritto 'Romeo e Giulietta'?", 
        new String[]{"Dante", "Shakespeare", "Molière", "Goethe"}, 2, 10, 1, 51);

    tutteDomande[51] = new Domanda("Quanti canti ha la Divina Commedia?", 
        new String[]{"33", "99", "100", "101"}, 3, 10, 2, 52);

    tutteDomande[52] = new Domanda("Chi è il re degli dei greci?", 
        new String[]{"Poseidone", "Ade", "Zeus", "Apollo"}, 3, 10, 1, 53);

    tutteDomande[53] = new Domanda("Quale pittore si tagliò un orecchio?", 
        new String[]{"Picasso", "Van Gogh", "Monet", "Dalì"}, 2, 10, 1, 54);

    tutteDomande[54] = new Domanda("Chi ha scritto 'Il Piccolo Principe'?", 
        new String[]{"Saint-Exupéry", "Rodari", "Collodi", "Dahl"}, 1, 10, 1, 55);

    tutteDomande[55] = new Domanda("Come si chiama il cavallo di Don Chisciotte?", 
        new String[]{"Furia", "Ronzinante", "Bucefalo", "Tornado"}, 2, 10, 2, 56);

    tutteDomande[56] = new Domanda("L'Eneide racconta la fondazione di quale città?", 
        new String[]{"Atene", "Sparta", "Roma", "Cartagine"}, 3, 10, 2, 57);

    tutteDomande[57] = new Domanda("Chi ha scritto la saga di Harry Potter?", 
        new String[]{"Tolkien", "King", "Rowling", "Lewis"}, 3, 10, 1, 58);

    tutteDomande[58] = new Domanda("Cosa proteggono le Muse nella mitologia?", 
        new String[]{"La guerra", "Le arti", "Il mare", "L'agricoltura"}, 2, 10, 2, 59);

    tutteDomande[59] = new Domanda("Chi ha dipinto 'La Nascita di Venere'?", 
        new String[]{"Raffaello", "Botticelli", "Tiziano", "Caravaggio"}, 2, 10, 2, 60);



    tutteDomande[60] = new Domanda("Come si chiama il topo più famoso della Disney?", 
        new String[]{"Jerry", "Topolino", "Stuart", "Speedy"}, 2, 10, 1, 61);

    tutteDomande[61] = new Domanda("Qual è il codice dell'agente James Bond?", 
        new String[]{"001", "007", "777", "911"}, 2, 10, 1, 62);

    tutteDomande[62] = new Domanda("Quale gruppo canta 'Mamma Mia'?", 
        new String[]{"Beatles", "Queen", "ABBA", "Rolling Stones"}, 3, 10, 1, 63);

    tutteDomande[63] = new Domanda("Chi è il protagonista di 'Pirati dei Caraibi'?", 
        new String[]{"Jack Sparrow", "Uncino", "Barbanera", "Will Turner"}, 1, 10, 1, 64);

    tutteDomande[64] = new Domanda("Come si chiama la città di Batman?", 
        new String[]{"Metropolis", "New York", "Gotham City", "Star City"}, 3, 10, 1, 65);

    tutteDomande[65] = new Domanda("Di che colore è la pantera dei cartoni?", 
        new String[]{"Nera", "Rosa", "Blu", "Viola"}, 2, 10, 1, 66);

    tutteDomande[66] = new Domanda("Chi è la compagna di Tarzan?", 
        new String[]{"Mary", "Lois", "Jane", "Alice"}, 3, 10, 1, 67);

    tutteDomande[67] = new Domanda("Quale band inglese cantava 'Yesterday'?", 
        new String[]{"Pink Floyd", "The Beatles", "The Who", "Led Zeppelin"}, 2, 10, 1, 68);

    tutteDomande[68] = new Domanda("Come si chiama l'orco verde dei film d'animazione?", 
        new String[]{"Hulk", "Shrek", "Fiona", "Grinch"}, 2, 10, 1, 69);

    tutteDomande[69] = new Domanda("Qual è il vero nome di Superman?", 
        new String[]{"Peter Parker", "Bruce Wayne", "Clark Kent", "Tony Stark"}, 3, 10, 1, 70);

    tutteDomande[70] = new Domanda("Chi è considerato il Re del Pop?", 
        new String[]{"Elvis Presley", "Prince", "Michael Jackson", "Madonna"}, 3, 10, 1, 71);

    tutteDomande[71] = new Domanda("In quale film un bambino perde l'aereo?", 
        new String[]{"Mamma ho perso l'aereo", "Ritorno al futuro", "E.T.", "Goonies"}, 1, 10, 1, 72);

    tutteDomande[72] = new Domanda("Quale frutto avvelenato mangia Biancaneve?", 
        new String[]{"Pera", "Mela", "Banana", "Fragola"}, 2, 10, 1, 73);

    tutteDomande[73] = new Domanda("Chi è il protagonista di Dragon Ball?", 
        new String[]{"Vegeta", "Goku", "Gohan", "Piccolo"}, 2, 10, 1, 74);

    tutteDomande[74] = new Domanda("Quale talent show cerca la voce migliore?", 
        new String[]{"X Factor", "Amici", "The Voice", "Got Talent"}, 3, 10, 1, 75);




    tutteDomande[75] = new Domanda("Quanti giocatori di calcio scendono in campo per squadra?", 
        new String[]{"7", "11", "15", "9"}, 2, 10, 1, 76);

    tutteDomande[76] = new Domanda("Di che colore è la maglia della Nazionale Italiana?", 
        new String[]{"Rossa", "Verde", "Bianca", "Azzurra"}, 4, 10, 1, 77);

    tutteDomande[77] = new Domanda("Quanti cerchi ci sono nella bandiera olimpica?", 
        new String[]{"3", "4", "5", "6"}, 3, 10, 1, 78);

    tutteDomande[78] = new Domanda("In quale sport si usa il volano?", 
        new String[]{"Tennis", "Badminton", "Ping Pong", "Squash"}, 2, 10, 2, 79);

    tutteDomande[79] = new Domanda("Quante caselle ha una scacchiera?", 
        new String[]{"32", "64", "100", "50"}, 2, 10, 2, 80);

    tutteDomande[80] = new Domanda("Qual è la lotta nazionale del Giappone?", 
        new String[]{"Judo", "Karate", "Sumo", "Aikido"}, 3, 10, 2, 81);

    tutteDomande[81] = new Domanda("Quanti secondi ci sono in un minuto?", 
        new String[]{"100", "60", "50", "30"}, 2, 10, 1, 82);

    tutteDomande[82] = new Domanda("Quali sono i colori della bandiera italiana?", 
        new String[]{"Verde Bianco Rosso", "Blu Bianco Rosso", "Giallo Rosso", "Verde Giallo"}, 1, 10, 1, 83);

    tutteDomande[83] = new Domanda("Quanti giorni ha un anno bisestile?", 
        new String[]{"364", "365", "366", "360"}, 3, 10, 1, 84);

    tutteDomande[84] = new Domanda("In che mese si festeggia Natale?", 
        new String[]{"Novembre", "Dicembre", "Gennaio", "Ottobre"}, 2, 10, 1, 85);

    tutteDomande[85] = new Domanda("Cosa si festeggia il 25 Aprile in Italia?", 
        new String[]{"Repubblica", "Lavoro", "Liberazione", "Natale"}, 3, 10, 1, 86);

    tutteDomande[86] = new Domanda("Quanti sono i segni zodiacali?", 
        new String[]{"10", "12", "13", "14"}, 2, 10, 1, 87);

    tutteDomande[87] = new Domanda("Quale uccello simboleggia la pace?", 
        new String[]{"Aquila", "Colomba", "Corvo", "Gabbiano"}, 2, 10, 1, 88);

    tutteDomande[88] = new Domanda("Quale strumento ha 88 tasti?", 
        new String[]{"Chitarra", "Pianoforte", "Violino", "Flauto"}, 2, 10, 2, 89);

    tutteDomande[89] = new Domanda("Quanto fa 7 per 8?", 
        new String[]{"48", "54", "56", "64"}, 3, 10, 1, 90);
        Domandiere domandiere = new Domandiere(tutteDomande);

        // -------------------------
        // creazione del tabellone
        // -------------------------
        int numCaselle=0;
        do{
            System.out.println("dimmi caselle quanto vuoi nel tabellone:");
            numCaselle = Leggi.unInt();
        }while(numCaselle <= 0);
        System.out.println("Numero caselle valido. Il tabellone ora ha "+numCaselle+ " caselle.");


        Casella[] caselle = new Casella[numCaselle];
        for (int i = 0; i < numCaselle; i++) {
            // uso modulo sulla lunghezza delle domande per evitare OOB
            caselle[i] = new Casella(i, "Casella " + (i + 1),
                tutteDomande[i % tutteDomande.length], 5);
            if (i > 0) {
                caselle[i].setPrecedente(caselle[i - 1]);
            }
            if (i < numCaselle - 1) {
                caselle[i].setSuccessiva(caselle[i + 1]);
            }
        }

        // -------------------------
        // inserimento giocatori (max 5)
        // -------------------------
        int numGiocatori;
        do {
            System.out.print("Inserisci il numero di giocatori (max 5): ");
            numGiocatori = Leggi.unInt();
        } while (numGiocatori < 1 || numGiocatori > 5);

        Giocatore[] giocatori = new Giocatore[numGiocatori];

        int punteggio_iniziale=50;
        for (int i = 0; i < numGiocatori; i++) {
            System.out.print("Nome giocatore " + (i + 1) + ": ");
            String nome = Leggi.unoString();
            System.out.print("Pedina (un carattere): ");
            char pedina = Leggi.unChar();
            giocatori[i] = new Giocatore(nome, pedina);
            giocatori[i].riceviPunti(punteggio_iniziale);
            // tutti partono dalla casella 0
            caselle[0].aggiungiGiocatore(giocatori[i]);
        }

        // -------------------------
        // creazione del dado
        // -------------------------
        Dado dado = new Dado(6);

        // -------------------------
        // ciclo di gioco principale
        // -------------------------
        boolean giocoFinito = false;

        while (!giocoFinito) {

            for (int i = 0; i < numGiocatori; i++) {

                Giocatore g = giocatori[i];

                // se eliminato salta
                if (g.getPunteggio() <= 0) {
                    System.out.println(g.getNome() + " ha punteggio 0 o negativo e salta il turno.");
                    continue;
                }

                System.out.println("\nTurno di " + g.getNome() + " (Punti: " + g.getPunteggio() + ")");
                System.out.print("Premi invio per lanciare i dadi...");
                Leggi.unoString();

                // lancio due dadi
                int lancio = dado.lancia2();
                System.out.println("Hai tirato: " + lancio);

                // posizione e calcolo nuova casella con rimbalzo + bonus
                Casella attuale = g.getCasellaCorrente();
                int posizioneAttuale = attuale.getId();
                int ultima = numCaselle - 1;
                int indiceNuovo = posizioneAttuale + lancio;

                if (indiceNuovo > ultima) {
                    double casuale = Math.random(); // 0..1
                    if (casuale < g.getBonus()) {
                        // successo: arriva alla finale
                        indiceNuovo = ultima;
                        System.out.println("Colpo di fortuna! Vai direttamente alla casella finale.");
                    } else {
                        // rimbalzo
                        int eccesso = indiceNuovo - ultima;
                        indiceNuovo = ultima - eccesso;
                        if (indiceNuovo < 0) {
                            indiceNuovo = 0;
                        }
                        System.out.println("Hai superato la fine! Rimbalzi alla casella " + (indiceNuovo + 1));
                        g.addBonus(); // +20%
                        System.out.println("Bonus aumentato al " + (int)(g.getBonus() * 100) + "%");
                    }
                }

                // spostamento effettivo
                Casella destinazione = caselle[indiceNuovo];
                attuale.rimuoviGiocatore(g);
                destinazione.aggiungiGiocatore(g);

                // prendo domanda casuale per il giocatore dal domandiere
                Domanda d = domandiere.scegli(g);

                if (d != null) {
                    System.out.println("\n" + destinazione.getTitolo());
                    System.out.println(d);
                    System.out.print("Inserisci la risposta: ");
                    String risposta = Leggi.unoString();

                    if (d.valutaRisposta(risposta)) {
                        System.out.println("Risposta corretta! +" + d.getPunti());
                        g.riceviPunti(d.getPunti());
                    } else {
                        System.out.println("Risposta sbagliata! Punti diminuiti.");
                        g.diminuisciPunteggio();
                    }
                } else {
                    System.out.println("Nessuna domanda disponibile in questo momento.");
                }

                // eliminazione se punteggio <= 0
                if(g.getPunteggio()<=0) {
                    System.out.println(g.getNome() + " è eliminato!");
                    destinazione.rimuoviGiocatore(g);
                    continue;
                }

                // lotta se ci sono più giocatori
                if (destinazione.getNumGiocatori() > 1) {
                    System.out.println("Inizio lotta!");
                    Giocatore avv = destinazione.getAltroGiocatore(g);
                    if (avv != null) {
                        int puntiVinti = lottaDadi(g, avv, dado);
                        if (puntiVinti > 0) {
                            g.riceviPunti(puntiVinti);
                            System.out.println(g.getNome() + " vince la lotta e guadagna " + puntiVinti + " punti!");
                        } else {
                            System.out.println("La lotta non ha assegnato punti al vincitore.");
                        }
                    }
                }

                // controllo vittoria (casella finale e punteggio positivo)
                if (destinazione.getId() == ultima && g.getPunteggio() > 0) {
                    System.out.println("\n" + g.getNome() + " HA VINTO!");
                    giocoFinito = true;
                    break;
                }
            } // end for giocatori
        } // end while giocoFinito

        // -------------------------
        // risultato finale
        // -------------------------
        System.out.println("\n=== PUNTEGGI FINALI ===");
        for (Giocatore gg : giocatori) {
            System.out.println(gg.getNome() + ": " + gg.getPunteggio());
        }
    } // end main

    // -------------------------
    // LOTTA TRA DUE GIOCATORI
    // -------------------------
    public static int lottaDadi(Giocatore g1, Giocatore g2, Dado dado) {
        int puntiVinti = 0;
        for (int i = 0; i < 3; i++) {
            int l1 = dado.lancia(dado.getNumeroFacce());
            int l2 = dado.lancia(dado.getNumeroFacce());
            if (l1 > l2) {
                puntiVinti = puntiVinti + 1;
            } else if (l2 > l1) {
                puntiVinti = puntiVinti - 1;
            }
        }
        if (puntiVinti > 0) {
            return g2.getPunteggio() / 2;
        } else {
            return 0;
        }
    }
}

